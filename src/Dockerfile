# Set the base image
FROM node:16.13

ARG PORT
ARG NODE_ENV
ARG DB_USERNAME
ARG DB_PASSWORD
ARG DB_NAME
ARG DB_HOST
ARG JWT_SECRET
ARG ALLOWED_ORIGINS

ENV PORT=${PORT} \
    NODE_ENV=${NODE_ENV} \
    DB_USERNAME=${DB_USERNAME} \
    DB_PASSWORD=${DB_PASSWORD} \
    DB_NAME=${DB_NAME} \
    DB_HOST=${DB_HOST} \
    JWT_SECRET=${JWT_SECRET} \
    ALLOWED_ORIGINS=${ALLOWED_ORIGINS}
    
WORKDIR /app

COPY package*.json ./

RUN npm install

COPY . .

CMD ["npm", "start"]
